<h1>Search</h1>
<%= form_tag search_stories_path, method: :get do %>
  <div class="input">
    <%= label_tag :tags, 'Tags' %>
    <%= text_field_tag :tags, params[:tags] %>
  </div>
  <div class="input">
    <%= label_tag :category, 'Category' %>
    <%= select_tag :category, options_from_collection_for_select(@categories, "id", "name", params[:category]) %>
  </div>
  <%= submit_tag "Search", name: nil %>
<% end %>

<h2>Search Results</h2>
<table class="table">
<% @stories.each do |story| %>
  <tr>
    <td><%= link_to story.title, story %></td>
    <td><%= story.summary %></td>
    <td><%= link_to story.category.name, search_stories_path(tags: params[:tags], category: story.category.id) %></td>
    <td><% story.active_tags.each do |tag| %>
      <a href="<%= search_stories_path(tags: tag.to_s, category: params[:category]) %>" class="tag-<%= tag.context %>"><%= tag.name %></a>
    <% end %></td>
  </tr>
<% end %>
</table>

<%= will_paginate @stories unless @stories.empty? %>

<div class="pagination-info">
  <%= page_entries_info @stories, model: 'fics' unless @stories.empty? %>
</div>
